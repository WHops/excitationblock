#include <stdio.h>
#include <math.h>
#include "auto_f2c.h"
#include "tmBVP.h"

int func (integer ndim, const double *u, const integer *icp, const double *par, integer ijac, double *f, double *dfdu, double *dfdp) {
  f[0]= (-350.0*h*pow(-100.0*v - 3.5, 3)*(v - 0.055)/(pow(-1 + 0.0301973834223185*exp(-100.0*v), 3)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 3)) - 1.0*v - 10.0*(v - 0.055)*(pow(Nap, 3) + Nap1 + Nap2 + Nap3) - 90.0*(v + 0.09)*(Kdr1 + Kdr2 + Kdr3 + Kdr4 + pow(n, 4)) - 0.065 + I)/Cm;
  f[1]= 1000.0*(-5.0*n + (-50.0*v - 1.7)/((-1 + 0.0333732699603261*exp(-100.0*v))*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)))))*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)));
  f[2]= 1000.0*(-5.0*h + 0.35*exp(-50.0*v - 29.0L/10.0L)/(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v))))*(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v)));
  f[3]= -3750.0*Nap3;
  f[4]= -2500.0*Nap2;
  f[5]= -1250.0*Nap1;
  f[6]= -1250.0*Nap + 1250.0/(1 + 0.263597138115727*exp(-66.6666666666667*v));
  f[7]= -4000.0*Kdr4*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)));
  f[8]= -3000.0*Kdr3*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)));
  f[9]= -2000.0*Kdr2*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)));
  f[10]= -1000.0*Kdr1*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)));
  f[11]= 1000.0*Kdr1*adKdr1*(-1.5625*exp(-12.5*v - 11.0L/20.0L) - 10.0/(-1 + 0.0333732699603261*exp(-100.0*v)) + (-33.3732699603261*v - 1.13469117865109)*exp(-100.0*v)/pow(-1 + 0.0333732699603261*exp(-100.0*v), 2)) + 2000.0*Kdr2*adKdr2*(-1.5625*exp(-12.5*v - 11.0L/20.0L) - 10.0/(-1 + 0.0333732699603261*exp(-100.0*v)) + (-33.3732699603261*v - 1.13469117865109)*exp(-100.0*v)/pow(-1 + 0.0333732699603261*exp(-100.0*v), 2)) + 3000.0*Kdr3*adKdr3*(-1.5625*exp(-12.5*v - 11.0L/20.0L) - 10.0/(-1 + 0.0333732699603261*exp(-100.0*v)) + (-33.3732699603261*v - 1.13469117865109)*exp(-100.0*v)/pow(-1 + 0.0333732699603261*exp(-100.0*v), 2)) + 4000.0*Kdr4*adKdr4*(-1.5625*exp(-12.5*v - 11.0L/20.0L) - 10.0/(-1 + 0.0333732699603261*exp(-100.0*v)) + (-33.3732699603261*v - 1.13469117865109)*exp(-100.0*v)/pow(-1 + 0.0333732699603261*exp(-100.0*v), 2)) - 21966.4281763106*adNap*exp(-66.6666666666667*v)/pow(1 + 0.263597138115727*exp(-66.6666666666667*v), 2) + adh*((5000.0*h - 350.0*exp(-50.0*v - 29.0L/10.0L)/(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v))))*(-3.5*exp(-50.0*v - 29.0L/10.0L) + 6.08100626252179*exp(-100.0*v)/pow(1 + 0.0608100626252179*exp(-100.0*v), 2)) - (-17500.0*exp(-50.0*v - 29.0L/10.0L)/(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v))) + 1000.0*(1.225*exp(-50.0*v - 29.0L/10.0L) - 2.12835219188263*exp(-100.0*v)/pow(1 + 0.0608100626252179*exp(-100.0*v), 2))*exp(-50.0*v - 29.0L/10.0L)/pow(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v)), 2))*(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v)))) + adn*((5000.0*n - 1000.0*(-50.0*v - 1.7)/((-1 + 0.0333732699603261*exp(-100.0*v))*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)))))*(-1.5625*exp(-12.5*v - 11.0L/20.0L) - 10.0/(-1 + 0.0333732699603261*exp(-100.0*v)) + (-33.3732699603261*v - 1.13469117865109)*exp(-100.0*v)/pow(-1 + 0.0333732699603261*exp(-100.0*v), 2)) - (125.0*exp(-12.5*v - 11.0L/20.0L) + 1000.0*(-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)))*((-50.0*v - 1.7)*(1.5625*exp(-12.5*v - 11.0L/20.0L) + 10.0/(-1 + 0.0333732699603261*exp(-100.0*v)) - (-33.3732699603261*v - 1.13469117865109)*exp(-100.0*v)/pow(-1 + 0.0333732699603261*exp(-100.0*v), 2))/((-1 + 0.0333732699603261*exp(-100.0*v))*pow(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)), 2)) - 50.0/((-1 + 0.0333732699603261*exp(-100.0*v))*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)))) + (-166.866349801631*v - 5.67345589325544)*exp(-100.0*v)/(pow(-1 + 0.0333732699603261*exp(-100.0*v), 2)*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)))))) + adv*(lam - (-90.0*Kdr1 - 90.0*Kdr2 - 90.0*Kdr3 - 90.0*Kdr4 - 10.0*pow(Nap, 3) - 10.0*Nap1 - 10.0*Nap2 - 10.0*Nap3 - 350.0*h*pow(-100.0*v - 3.5, 3)*(v - 0.055)*(666.666666666667*exp(-55.5555555555556*v - 10.0L/3.0L) + 300.0/(-1 + 0.0301973834223185*exp(-100.0*v)) - (-905.921502669555*v - 31.7072525934344)*exp(-100.0*v)/pow(-1 + 0.0301973834223185*exp(-100.0*v), 2))/(pow(-1 + 0.0301973834223185*exp(-100.0*v), 3)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 4)) - 350.0*h*pow(-100.0*v - 3.5, 3)/(pow(-1 + 0.0301973834223185*exp(-100.0*v), 3)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 3)) + 105000.0*h*pow(-100.0*v - 3.5, 2)*(v - 0.055)/(pow(-1 + 0.0301973834223185*exp(-100.0*v), 3)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 3)) - 3170.72525934344*h*pow(-100.0*v - 3.5, 3)*(v - 0.055)*exp(-100.0*v)/(pow(-1 + 0.0301973834223185*exp(-100.0*v), 4)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 3)) - 90.0*pow(n, 4) - 1.0)/Cm);
  f[12]= adn*(lam + 625.0*exp(-12.5*v - 11.0L/20.0L) + (-50000.0*v - 1700.0)/(-1 + 0.0333732699603261*exp(-100.0*v))) + 360.0*adv*pow(n, 3)*(v + 0.09)/Cm;
  f[13]= adh*(lam + 350.0*exp(-50.0*v - 29.0L/10.0L) + 5000.0/(1 + 0.0608100626252179*exp(-100.0*v))) + 350.0*adv*pow(-100.0*v - 3.5, 3)*(v - 0.055)/(Cm*pow(-1 + 0.0301973834223185*exp(-100.0*v), 3)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 3));
  f[14]= adNap3*(lam + 3750.0) - adv*(-10.0*v + 0.55)/Cm;
  f[15]= adNap2*(lam + 2500.0) - adv*(-10.0*v + 0.55)/Cm;
  f[16]= adNap1*(lam + 1250.0) - adv*(-10.0*v + 0.55)/Cm;
  f[17]= adNap*(lam + 1250.0) + 30.0*pow(Nap, 2)*adv*(v - 0.055)/Cm;
  f[18]= adKdr4*(lam + 500.0*exp(-12.5*v - 11.0L/20.0L) + (-40000.0*v - 1360.0)/(-1 + 0.0333732699603261*exp(-100.0*v))) - adv*(-90.0*v - 8.1)/Cm;
  f[19]= adKdr3*(lam + 375.0*exp(-12.5*v - 11.0L/20.0L) + (-30000.0*v - 1020.0)/(-1 + 0.0333732699603261*exp(-100.0*v))) - adv*(-90.0*v - 8.1)/Cm;
  f[20]= adKdr2*(lam + 250.0*exp(-12.5*v - 11.0L/20.0L) + (-20000.0*v - 680.0)/(-1 + 0.0333732699603261*exp(-100.0*v))) - adv*(-90.0*v - 8.1)/Cm;
  f[21]= adKdr1*(lam + 125.0*exp(-12.5*v - 11.0L/20.0L) + (-10000.0*v - 340.0)/(-1 + 0.0333732699603261*exp(-100.0*v))) - adv*(-90.0*v - 8.1)/Cm;
  int i;
  for (i = 0; i < 22; i++)
    f[i]*= period;
  return 0;
}

int stpnt (integer ndim, double t, double *u, double *par) {
  par[0]= 0.0015288664395;
  par[1]= 0;
  par[2]= 0.965674158531;
  par[3]= 0.01;
  par[10]= 0.14998867815;
  u[0]= 0;
  u[1]= 0;
  u[2]= 0;
  u[3]= 0;
  u[4]= 0;
  u[5]= 0;
  u[6]= 0;
  u[7]= 0;
  u[8]= 0;
  u[9]= 0;
  u[10]= 0;
  u[11]= 0;
  u[12]= 0;
  u[13]= 0;
  u[14]= 0;
  u[15]= 0;
  u[16]= 0;
  u[17]= 0;
  u[18]= 0;
  u[19]= 0;
  u[20]= 0;
  u[21]= 0;
  return 0;
}

int icnd (integer ndim, const double *par, const integer *icp, integer nint, const double *u, const double *uold, const double *udot, const double *upold, integer ijac, double *fi, double *dint) {
  fi[0]= -1000.0*Kdr1*adKdr1*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v))) - 2000.0*Kdr2*adKdr2*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v))) - 3000.0*Kdr3*adKdr3*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v))) - 4000.0*Kdr4*adKdr4*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v))) - 1250.0*Nap1*adNap1 - 2500.0*Nap2*adNap2 - 3750.0*Nap3*adNap3 + adNap*(-1250.0*Nap + 1250.0/(1 + 0.263597138115727*exp(-66.6666666666667*v))) + 1000.0*adh*(-5.0*h + 0.35*exp(-50.0*v - 29.0L/10.0L)/(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v))))*(0.07*exp(-50.0*v - 29.0L/10.0L) + 1.0/(1 + 0.0608100626252179*exp(-100.0*v))) + 1000.0*adn*(-5.0*n + (-50.0*v - 1.7)/((-1 + 0.0333732699603261*exp(-100.0*v))*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v)))))*(0.125*exp(-12.5*v - 11.0L/20.0L) + (-10.0*v - 0.34)/(-1 + 0.0333732699603261*exp(-100.0*v))) - dotZF/period + adv*(-350.0*h*pow(-100.0*v - 3.5, 3)*(v - 0.055)/(pow(-1 + 0.0301973834223185*exp(-100.0*v), 3)*pow(4*exp(-55.5555555555556*v - 10.0L/3.0L) + (-100.0*v - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v)), 3)) - 1.0*v - (10.0*v - 0.55)*(pow(Nap, 3) + Nap1 + Nap2 + Nap3) - (90.0*v + 8.1)*(Kdr1 + Kdr2 + Kdr3 + Kdr4 + pow(n, 4)) - 0.065 + I)/Cm;
  return 0;
}

int bcnd (integer ndim, const double *par, const integer *icp, integer nbc, const double *u0, const double *u1, integer ijac, double *fb, double *dbc) {
  fb[0]= v_left - v_right;
  fb[1]= n_left - n_right;
  fb[2]= h_left - h_right;
  fb[3]= Nap3_left - Nap3_right;
  fb[4]= Nap2_left - Nap2_right;
  fb[5]= Nap1_left - Nap1_right;
  fb[6]= Nap_left - Nap_right;
  fb[7]= Kdr4_left - Kdr4_right;
  fb[8]= Kdr3_left - Kdr3_right;
  fb[9]= Kdr2_left - Kdr2_right;
  fb[10]= Kdr1_left - Kdr1_right;
  fb[11]= adv_left - adv_right;
  fb[12]= adn_left - adn_right;
  fb[13]= adh_left - adh_right;
  fb[14]= adNap3_left - adNap3_right;
  fb[15]= adNap2_left - adNap2_right;
  fb[16]= adNap1_left - adNap1_right;
  fb[17]= adNap_left - adNap_right;
  fb[18]= adKdr4_left - adKdr4_right;
  fb[19]= adKdr3_left - adKdr3_right;
  fb[20]= adKdr2_left - adKdr2_right;
  fb[21]= adKdr1_left - adKdr1_right;
  fb[22]= (-350.0*h_left*pow(-100.0*v_left - 3.5, 3)*(v_left - 0.055)/(pow(-1 + 0.0301973834223185*exp(-100.0*v_left), 3)*pow(4*exp(-55.5555555555556*v_left - 10.0L/3.0L) + (-100.0*v_left - 3.5)/(-1 + 0.0301973834223185*exp(-100.0*v_left)), 3)) - 1.0*v_left - (10.0*v_left - 0.55)*(Nap1_left + Nap2_left + Nap3_left + pow(Nap_left, 3)) - (90.0*v_left + 8.1)*(Kdr1_left + Kdr2_left + Kdr3_left + Kdr4_left + pow(n_left, 4)) - 0.065 + I)/Cm;
  return 0;
}

int fopt (integer ndim, const double *u, const integer *icp, const double *par, integer ijac, double *fs, double *dfdu, double *dfdp) {
  return 0;
}

int pvls (integer ndim, const double *u, double *par) {
  return 0;
}
